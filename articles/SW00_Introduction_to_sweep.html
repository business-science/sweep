<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sweep">
<title>Introduction to sweep • sweep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to sweep">
<meta property="og:description" content="sweep">
<meta property="og:image" content="https://business-science.github.io/sweep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-20GDZ5LL77"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-20GDZ5LL77');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sweep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/SW00_Introduction_to_sweep.html">Start</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-api">API</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-api">
    <h6 class="dropdown-header" data-toc-skip>API Functions</h6>
    <a class="dropdown-item" href="../reference/index.html">
      <span class="fa fa-home"></span>
       
      Function Reference
    </a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Change History</h6>
    <a class="dropdown-item" href="../news/index.html">News</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/business-science/sweep">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to sweep</h1>
                        <h4 data-toc-skip class="author">Matt
Dancho</h4>
            
            <h4 data-toc-skip class="date">2024-01-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/sweep/blob/HEAD/vignettes/SW00_Introduction_to_sweep.Rmd" class="external-link"><code>vignettes/SW00_Introduction_to_sweep.Rmd</code></a></small>
      <div class="d-none name"><code>SW00_Introduction_to_sweep.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>Extending <code>broom</code> to time series forecasting</p>
</blockquote>
<p>The <code>sweep</code> package extends the <code>broom</code> tools
(tidy, glance, and augment) for performing forecasts and time series
analysis in the “tidyverse”. The package is geared towards the workflow
required to perform forecasts using Rob Hyndman’s <code>forecast</code>
package, and contains the following elements:</p>
<ol style="list-style-type: decimal">
<li><p><strong>model tidiers</strong>: <code>sw_tidy</code>,
<code>sw_glance</code>, <code>sw_augment</code>,
<code>sw_tidy_decomp</code> functions extend <code>tidy</code>,
<code>glance</code>, and <code>augment</code> from the
<code>broom</code> package specifically for models (<code><a href="https://pkg.robjhyndman.com/forecast/reference/ets.html" class="external-link">ets()</a></code>,
<code><a href="https://pkg.robjhyndman.com/forecast/reference/Arima.html" class="external-link">Arima()</a></code>, <code><a href="https://pkg.robjhyndman.com/forecast/reference/bats.html" class="external-link">bats()</a></code>, etc) used for
forecasting.</p></li>
<li><p><strong>forecast tidier</strong>: <code>sw_sweep</code> converts
a <code>forecast</code> object to a tibble that can be easily
manipulated in the “tidyverse”.</p></li>
</ol>
<p>To illustrate, let’s take a basic forecasting workflow starting from
data collected in a tibble format and then performing a forecast to
achieve the end result in tibble format.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>Before we get started, load the following packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/tidyquant" class="external-link">tidyquant</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/timetk" class="external-link">timetk</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://business-science.github.io/sweep/">sweep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="forecasting-sales-of-beer-wine-and-distilled-alcohol-beverages">Forecasting Sales of Beer, Wine, and Distilled Alcohol
Beverages<a class="anchor" aria-label="anchor" href="#forecasting-sales-of-beer-wine-and-distilled-alcohol-beverages"></a>
</h2>
<p>We’ll use the <code>tidyquant</code> package to get the US alcohol
sales, which comes from the FRED data base (the origin is the US Bureau
of the Census, one of the 80+ data sources FRED connects to). The FRED
code is “S4248SM144NCEN” and the data set can be found <a href="https://fred.stlouisfed.org/series/S4248SM144NCEN" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_sales_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_get.html" class="external-link">tq_get</a></span><span class="op">(</span><span class="st">"S4248SM144NCEN"</span>, </span>
<span>                            get  <span class="op">=</span> <span class="st">"economic.data"</span>, </span>
<span>                            from <span class="op">=</span> <span class="st">"2007-01-01"</span>,</span>
<span>                            to   <span class="op">=</span> <span class="st">"2016-12-31"</span><span class="op">)</span></span>
<span><span class="va">alcohol_sales_tbl</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 3</span></span></span>
<span><span class="co">##    symbol         date       price</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> S4248SM144NCEN 2007-01-01  <span style="text-decoration: underline;">6</span>627</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> S4248SM144NCEN 2007-02-01  <span style="text-decoration: underline;">6</span>743</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> S4248SM144NCEN 2007-03-01  <span style="text-decoration: underline;">8</span>195</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> S4248SM144NCEN 2007-04-01  <span style="text-decoration: underline;">7</span>828</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> S4248SM144NCEN 2007-05-01  <span style="text-decoration: underline;">9</span>570</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> S4248SM144NCEN 2007-06-01  <span style="text-decoration: underline;">9</span>484</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> S4248SM144NCEN 2007-07-01  <span style="text-decoration: underline;">8</span>608</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> S4248SM144NCEN 2007-08-01  <span style="text-decoration: underline;">9</span>543</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> S4248SM144NCEN 2007-09-01  <span style="text-decoration: underline;">8</span>123</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> S4248SM144NCEN 2007-10-01  <span style="text-decoration: underline;">9</span>649</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span></code></pre>
<p>We can quickly visualize using the <code>ggplot2</code> package. We
can see that there appears to be some seasonality and an upward
trend.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_sales_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html" class="external-link">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Alcohol Sales: Monthly"</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Millions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html" class="external-link">theme_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="SW00_Introduction_to_sweep_files/figure-html/unnamed-chunk-4-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="forecasting-workflow">Forecasting Workflow<a class="anchor" aria-label="anchor" href="#forecasting-workflow"></a>
</h2>
<p>The forecasting workflow involves a few basic steps:</p>
<ol style="list-style-type: decimal">
<li>Step 1: Coerce to a <code>ts</code> object class.</li>
<li>Step 2: Apply a model (or set of models)</li>
<li>Step 3: Forecast the models (similar to predict)</li>
<li>Step 4: Use <code><a href="../reference/sw_sweep.html">sw_sweep()</a></code> to tidy the forecast.</li>
</ol>
<p><em>Note that we purposely omit other steps such as testing the
series for stationarity (<code>Box.test(type = "Ljung")</code>) and
analysis of autocorrelations (<code>Acf</code>, <code>Pacf</code>) for
brevity purposes. We recommend the analyst to follow the forecasting
workflow in <a href="https://otexts.com/fpp2/" class="external-link">“Forecasting: principles
and practice”</a></em></p>
<div class="section level3">
<h3 id="step-1-coerce-to-a-ts-object-class">Step 1: Coerce to a <code>ts</code> object class<a class="anchor" aria-label="anchor" href="#step-1-coerce-to-a-ts-object-class"></a>
</h3>
<p>The <code>forecast</code> package uses the <code>ts</code> data
structure, which is quite a bit different than tibbles that we are
currently using. Fortunately, it’s easy to get to the correct structure
with <code><a href="https://rdrr.io/pkg/timetk/man/tk_ts.html" class="external-link">tk_ts()</a></code> from the <code>timetk</code> package. The
<code>start</code> and <code>freq</code> variables are required for the
regularized time series (<code>ts</code>) class, and these specify how
to treat the time series. For monthly, the frequency should be specified
as 12. This results in a nice calendar view. The
<code>silent = TRUE</code> tells the <code><a href="https://rdrr.io/pkg/timetk/man/tk_ts.html" class="external-link">tk_ts()</a></code> function to
skip the warning notifying us that the “date” column is being dropped.
Non-numeric columns must be dropped for <code>ts</code> class, which is
matrix based and a homogeneous data class.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_sales_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/tk_ts.html" class="external-link">tk_ts</a></span><span class="op">(</span><span class="va">alcohol_sales_tbl</span>, start <span class="op">=</span> <span class="fl">2007</span>, freq <span class="op">=</span> <span class="fl">12</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">alcohol_sales_ts</span></span></code></pre></div>
<pre><code><span><span class="co">##        Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec</span></span>
<span><span class="co">## 2007  6627  6743  8195  7828  9570  9484  8608  9543  8123  9649  9390 10065</span></span>
<span><span class="co">## 2008  7093  7483  8365  8895  9794  9977  9553  9375  9225  9948  8758 10839</span></span>
<span><span class="co">## 2009  7266  7578  8688  9162  9369 10167  9507  8923  9272  9075  8949 10843</span></span>
<span><span class="co">## 2010  6558  7481  9475  9424  9351 10552  9077  9273  9420  9413  9866 11455</span></span>
<span><span class="co">## 2011  6901  8014  9832  9281  9967 11344  9106 10469 10085  9612 10328 11483</span></span>
<span><span class="co">## 2012  7486  8641  9709  9423 11342 11274  9845 11163  9532 10754 10953 11922</span></span>
<span><span class="co">## 2013  8383  8870 10085 10462 12177 11342 11139 11409 10442 11479 11077 12636</span></span>
<span><span class="co">## 2014  8506  9003  9991 10903 11709 11815 10875 10884 10725 11697 10353 13153</span></span>
<span><span class="co">## 2015  8279  8926 10557 10933 11330 12708 11700 11079 11882 11865 11420 14100</span></span>
<span><span class="co">## 2016  8556 10199 11949 11253 12046 13453 10755 12465 12038 11674 12761 14137</span></span></code></pre>
<p>A significant benefit is that the resulting <code>ts</code> object
maintains a “timetk index”, which will help with forecasting dates
later. We can verify this using <code><a href="https://rdrr.io/pkg/timetk/man/tk_index.html" class="external-link">has_timetk_idx()</a></code> from the
<code>timetk</code> package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/timetk/man/tk_index.html" class="external-link">has_timetk_idx</a></span><span class="op">(</span><span class="va">alcohol_sales_ts</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Now that a time series has been coerced, let’s proceed with
modeling.</p>
</div>
<div class="section level3">
<h3 id="step-2-modeling-a-time-series">Step 2: Modeling a time series<a class="anchor" aria-label="anchor" href="#step-2-modeling-a-time-series"></a>
</h3>
<p>The modeling workflow takes a time series object and applies a model.
Nothing new here: we’ll simply use the <code><a href="https://pkg.robjhyndman.com/forecast/reference/ets.html" class="external-link">ets()</a></code> function from
the <code>forecast</code> package to get an Exponential Smoothing ETS
(Error, Trend, Seasonal) model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_ets</span> <span class="op">&lt;-</span> <span class="va">alcohol_sales_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/ets.html" class="external-link">ets</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Where <code>sweep</code> can help is in the evaluation of a model.
Expanding on the <code>broom</code> package there are four
functions:</p>
<ul>
<li>
<code><a href="../reference/sw_tidy.html">sw_tidy()</a></code>: Returns a tibble of model parameters</li>
<li>
<code><a href="../reference/sw_glance.html">sw_glance()</a></code>: Returns the model accuracy
measurements</li>
<li>
<code><a href="../reference/sw_augment.html">sw_augment()</a></code>: Returns the fitted and residuals of the
model</li>
<li>
<code><a href="../reference/sw_tidy_decomp.html">sw_tidy_decomp()</a></code>: Returns a tidy decomposition from a
model</li>
</ul>
<p>The guide below shows which model object compatibility with
<code>sweep</code> tidier functions.</p>
<table class="table">
<caption>Function Compatibility</caption>
<colgroup>
<col width="15%">
<col width="13%">
<col width="16%">
<col width="17%">
<col width="22%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">Object</th>
<th align="center">sw_tidy()</th>
<th align="center">sw_glance()</th>
<th align="center">sw_augment()</th>
<th align="center">sw_tidy_decomp()</th>
<th align="center">sw_sweep()</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ar</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">arima</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Arima</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">ets</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">baggedETS</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">bats</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">tbats</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">nnetar</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">stl</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">HoltWinters</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">StructTS</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">tslm</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">decompose</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">adf.test</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Box.test</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">kpss.test</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">forecast</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
</tr>
</tbody>
</table>
<p>Going through the tidiers, we can get useful <code>model</code>
information.</p>
<div class="section level4">
<h4 id="sw_tidy">sw_tidy<a class="anchor" aria-label="anchor" href="#sw_tidy"></a>
</h4>
<p><code><a href="../reference/sw_tidy.html">sw_tidy()</a></code> returns the model parameters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_tidy.html">sw_tidy</a></span><span class="op">(</span><span class="va">fit_ets</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 17 × 2</span></span></span>
<span><span class="co">##    term     estimate</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> alpha    0.159   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> beta     0.018<span style="text-decoration: underline;">0</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> gamma    0.000<span style="text-decoration: underline;">107</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> phi      0.970   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> l     <span style="text-decoration: underline;">8</span>389.      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> b       38.9     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> s0       1.17    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> s1       1.02    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> s2       1.04    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> s3       0.995   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> s4       1.04    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> s5       0.993   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> s6       1.12    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> s7       1.07    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> s8       0.982   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> s9       0.975   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> s10      0.837</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sw_glance">sw_glance<a class="anchor" aria-label="anchor" href="#sw_glance"></a>
</h4>
<p><code><a href="../reference/sw_glance.html">sw_glance()</a></code> returns the model quality parameters.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_glance.html">sw_glance</a></span><span class="op">(</span><span class="va">fit_ets</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 12</span></span></span>
<span><span class="co">##   model.desc   sigma logLik   AIC   BIC    ME  RMSE   MAE   MPE  MAPE  MASE</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> ETS(M,Ad,M) 0.045<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">012.</span> <span style="text-decoration: underline;">2</span>060. <span style="text-decoration: underline;">2</span>111.  40.7  431.  357. 0.223  3.54 0.705</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: ACF1 &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sw_augment">sw_augment<a class="anchor" aria-label="anchor" href="#sw_augment"></a>
</h4>
<p><code><a href="../reference/sw_augment.html">sw_augment()</a></code> returns the actual, fitted and residual
values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">augment_fit_ets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sw_augment.html">sw_augment</a></span><span class="op">(</span><span class="va">fit_ets</span><span class="op">)</span></span>
<span><span class="va">augment_fit_ets</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 120 × 4</span></span></span>
<span><span class="co">##    index     .actual .fitted   .resid</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;yearmon&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Jan 2007     <span style="text-decoration: underline;">6</span>627   <span style="text-decoration: underline;">6</span>446.  0.028<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Feb 2007     <span style="text-decoration: underline;">6</span>743   <span style="text-decoration: underline;">7</span>122. -<span style="color: #BB0000;">0.053</span><span style="color: #BB0000; text-decoration: underline;">2</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Mar 2007     <span style="text-decoration: underline;">8</span>195   <span style="text-decoration: underline;">8</span>255. -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">30</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Apr 2007     <span style="text-decoration: underline;">7</span>828   <span style="text-decoration: underline;">8</span>330. -<span style="color: #BB0000;">0.060</span><span style="color: #BB0000; text-decoration: underline;">3</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> May 2007     <span style="text-decoration: underline;">9</span>570   <span style="text-decoration: underline;">8</span>986.  0.065<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Jun 2007     <span style="text-decoration: underline;">9</span>484   <span style="text-decoration: underline;">9</span>541. -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">97</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Jul 2007     <span style="text-decoration: underline;">8</span>608   <span style="text-decoration: underline;">8</span>500.  0.012<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Aug 2007     <span style="text-decoration: underline;">9</span>543   <span style="text-decoration: underline;">8</span>932.  0.068<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Sep 2007     <span style="text-decoration: underline;">8</span>123   <span style="text-decoration: underline;">8</span>694. -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">7</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Oct 2007     <span style="text-decoration: underline;">9</span>649   <span style="text-decoration: underline;">8</span>977.  0.074<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 110 more rows</span></span></span></code></pre>
<p>We can review the residuals to determine if their are any underlying
patterns left. Note that the index is class <code>yearmon</code>, which
is a regularized date format.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">augment_fit_ets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html" class="external-link">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_yearmon</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Alcohol Sales: ETS Residuals"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html" class="external-link">theme_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="SW00_Introduction_to_sweep_files/figure-html/unnamed-chunk-12-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="sw_tidy_decomp">sw_tidy_decomp<a class="anchor" aria-label="anchor" href="#sw_tidy_decomp"></a>
</h4>
<p><code><a href="../reference/sw_tidy_decomp.html">sw_tidy_decomp()</a></code> returns the decomposition of the ETS
model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decomp_fit_ets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sw_tidy_decomp.html">sw_tidy_decomp</a></span><span class="op">(</span><span class="va">fit_ets</span><span class="op">)</span></span>
<span><span class="va">decomp_fit_ets</span> </span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 121 × 5</span></span></span>
<span><span class="co">##    index     observed level slope season</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;yearmon&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Dec 2006        <span style="color: #BB0000;">NA</span> <span style="text-decoration: underline;">8</span>389.  38.9  1.17 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Jan 2007      <span style="text-decoration: underline;">6</span>627 <span style="text-decoration: underline;">8</span>464.  42.0  0.765</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Feb 2007      <span style="text-decoration: underline;">6</span>743 <span style="text-decoration: underline;">8</span>433.  32.6  0.837</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Mar 2007      <span style="text-decoration: underline;">8</span>195 <span style="text-decoration: underline;">8</span>455.  30.5  0.975</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Apr 2007      <span style="text-decoration: underline;">7</span>828 <span style="text-decoration: underline;">8</span>404.  20.4  0.982</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> May 2007      <span style="text-decoration: underline;">9</span>570 <span style="text-decoration: underline;">8</span>510.  29.6  1.07 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Jun 2007      <span style="text-decoration: underline;">9</span>484 <span style="text-decoration: underline;">8</span>531.  27.8  1.12 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Jul 2007      <span style="text-decoration: underline;">8</span>608 <span style="text-decoration: underline;">8</span>575.  29.0  0.993</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Aug 2007      <span style="text-decoration: underline;">9</span>543 <span style="text-decoration: underline;">8</span>697.  38.7  1.04 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Sep 2007      <span style="text-decoration: underline;">8</span>123 <span style="text-decoration: underline;">8</span>643.  27.2  0.995</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 111 more rows</span></span></span></code></pre>
<p>We can review the decomposition using <code>ggplot2</code> as well.
The data will need to be manipulated slightly for the facet
visualization. The <code>gather()</code> function from the
<code>tidyr</code> package is used to reshape the data into a long
format data frame with column names “key” and “value” indicating all
columns except for index are to be reshaped. The “key” column is then
mutated using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> to a factor which preserves the
order of the keys so “observed” comes first when plotting.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decomp_fit_ets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">key</span>, value <span class="op">=</span> <span class="va">value</span>, <span class="op">-</span><span class="va">index</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">key</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html" class="external-link">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/geom_ma.html" class="external-link">geom_ma</a></span><span class="op">(</span>ma_fun <span class="op">=</span> <span class="va">SMA</span>, n <span class="op">=</span> <span class="fl">12</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_yearmon</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Alcohol Sales: ETS Decomposition"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html" class="external-link">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` in the `default_aes` field and elsewhere instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="SW00_Introduction_to_sweep_files/figure-html/unnamed-chunk-14-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Under normal circumstances it would make sense to refine the model at
this point. However, in the interest of showing capabilities (rather
than how to forecast) we move onto forecasting the model. For more
information on how to forecast, please refer to the online book <a href="https://otexts.com/fpp2/" class="external-link"><em>“Forecasting: principles and
practices”</em></a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="step-3-forecasting-the-model">Step 3: Forecasting the model<a class="anchor" aria-label="anchor" href="#step-3-forecasting-the-model"></a>
</h3>
<p>Next we forecast the ETS model using the <code><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast()</a></code>
function. The returned <code>forecast</code> object isn’t in a “tidy”
format (i.e. data frame). This is where the <code><a href="../reference/sw_sweep.html">sw_sweep()</a></code>
function helps.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fcast_ets</span> <span class="op">&lt;-</span> <span class="va">fit_ets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-tidy-the-forecast-object">Step 4: Tidy the forecast object<a class="anchor" aria-label="anchor" href="#step-4-tidy-the-forecast-object"></a>
</h3>
<p>We’ll use the <code><a href="../reference/sw_sweep.html">sw_sweep()</a></code> function to coerce a
<code>forecast</code> into a “tidy” data frame. The
<code><a href="../reference/sw_sweep.html">sw_sweep()</a></code> function then coerces the <code>forecast</code>
object into a tibble that can be sent to <code>ggplot</code> for
visualization. Let’s inspect the result.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_sweep.html">sw_sweep</a></span><span class="op">(</span><span class="va">fcast_ets</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 252 × 7</span></span></span>
<span><span class="co">##    index     key    price lo.80 lo.95 hi.80 hi.95</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;yearmon&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Jan 2007  actual  <span style="text-decoration: underline;">6</span>627    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Feb 2007  actual  <span style="text-decoration: underline;">6</span>743    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Mar 2007  actual  <span style="text-decoration: underline;">8</span>195    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Apr 2007  actual  <span style="text-decoration: underline;">7</span>828    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> May 2007  actual  <span style="text-decoration: underline;">9</span>570    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Jun 2007  actual  <span style="text-decoration: underline;">9</span>484    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Jul 2007  actual  <span style="text-decoration: underline;">8</span>608    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Aug 2007  actual  <span style="text-decoration: underline;">9</span>543    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Sep 2007  actual  <span style="text-decoration: underline;">8</span>123    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Oct 2007  actual  <span style="text-decoration: underline;">9</span>649    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 242 more rows</span></span></span></code></pre>
<p>The tibble returned contains “index”, “key” and “value” (or in this
case “price”) columns in a long or “tidy” format that is ideal for
visualization with <code>ggplot2</code>. The “index” is in a regularized
format (in this case <code>yearmon</code>) because the
<code>forecast</code> package uses <code>ts</code> objects. We’ll see
how we can get back to the original irregularized format (in this case
<code>date</code>) later. The “key” and “price” columns contains three
groups of key-value pairs:</p>
<ol style="list-style-type: decimal">
<li>
<strong>actual</strong>: the actual values from the original
data</li>
<li>
<strong>fitted</strong>: the model values returned from the
<code><a href="https://pkg.robjhyndman.com/forecast/reference/ets.html" class="external-link">ets()</a></code> function (excluded by default)</li>
<li>
<strong>forecast</strong>: the predicted values from the
<code><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast()</a></code> function</li>
</ol>
<p>The <code><a href="../reference/sw_sweep.html">sw_sweep()</a></code> function contains an argument
<code>fitted = FALSE</code> by default meaning that the model “fitted”
values are not returned. We can toggle this on if desired. The remaining
columns are the forecast confidence intervals (typically 80 and 95, but
this can be changed with <code>forecast(level = c(80, 95))</code>).
These columns are setup in a wide format to enable using the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon()</a></code>.</p>
<p>Let’s visualize the forecast with <code>ggplot2</code>. We’ll use a
combination of <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon()</a></code>.
The fitted values are toggled off by default to reduce the complexity of
the plot, but these can be added if desired. Note that because we are
using a regular time index of the <code>yearmon</code> class, we need to
add <code>scale_x_yearmon()</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_sweep.html">sw_sweep</a></span><span class="op">(</span><span class="va">fcast_ets</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">price</span>, color <span class="op">=</span> <span class="va">key</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lo.95</span>, ymax <span class="op">=</span> <span class="va">hi.95</span><span class="op">)</span>, </span>
<span>                fill <span class="op">=</span> <span class="st">"#D5DBFF"</span>, color <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lo.80</span>, ymax <span class="op">=</span> <span class="va">hi.80</span>, fill <span class="op">=</span> <span class="va">key</span><span class="op">)</span>, </span>
<span>                fill <span class="op">=</span> <span class="st">"#596DD5"</span>, color <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Alcohol Sales, ETS Model Forecast"</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Millions"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"Regular Time Index"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">label_dollar</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_yearmon</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span>, format <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html" class="external-link">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html" class="external-link">scale_fill_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html" class="external-link">theme_tq</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="SW00_Introduction_to_sweep_files/figure-html/unnamed-chunk-17-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Because the <code>ts</code> object was created with the
<code><a href="https://rdrr.io/pkg/timetk/man/tk_ts.html" class="external-link">tk_ts()</a></code> function, it contained a timetk index that was
carried with it throughout the forecasting workflow. As a result, we can
use the <code>timetk_idx</code> argument, which maps the original
irregular index (dates) and a generated future index to the regularized
time series (yearmon). This results in the ability to return an index of
date and datetime, which is not currently possible with the
<code>forecast</code> objects. Notice that the index is returned as
<code>date</code> class.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_sweep.html">sw_sweep</a></span><span class="op">(</span><span class="va">fcast_ets</span>, timetk_idx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .check_tzones(e1, e2): 'tzone' attributes are inconsistent</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   index      key    price lo.80 lo.95 hi.80 hi.95</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2007-01-01 actual  <span style="text-decoration: underline;">6</span>627    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2007-02-01 actual  <span style="text-decoration: underline;">6</span>743    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2007-03-01 actual  <span style="text-decoration: underline;">8</span>195    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2007-04-01 actual  <span style="text-decoration: underline;">7</span>828    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2007-05-01 actual  <span style="text-decoration: underline;">9</span>570    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 2007-06-01 actual  <span style="text-decoration: underline;">9</span>484    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_sweep.html">sw_sweep</a></span><span class="op">(</span><span class="va">fcast_ets</span>, timetk_idx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .check_tzones(e1, e2): 'tzone' attributes are inconsistent</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   index      key       price  lo.80  lo.95  hi.80  hi.95</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2017-07-01 forecast <span style="text-decoration: underline;">12</span>117. <span style="text-decoration: underline;">11</span>309. <span style="text-decoration: underline;">10</span>882. <span style="text-decoration: underline;">12</span>924. <span style="text-decoration: underline;">13</span>351.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2017-08-01 forecast <span style="text-decoration: underline;">12</span>697. <span style="text-decoration: underline;">11</span>828. <span style="text-decoration: underline;">11</span>367. <span style="text-decoration: underline;">13</span>566. <span style="text-decoration: underline;">14</span>027.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2017-09-01 forecast <span style="text-decoration: underline;">12</span>203. <span style="text-decoration: underline;">11</span>343. <span style="text-decoration: underline;">10</span>888. <span style="text-decoration: underline;">13</span>063. <span style="text-decoration: underline;">13</span>518.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2017-10-01 forecast <span style="text-decoration: underline;">12</span>723. <span style="text-decoration: underline;">11</span>800. <span style="text-decoration: underline;">11</span>311. <span style="text-decoration: underline;">13</span>647. <span style="text-decoration: underline;">14</span>136.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2017-11-01 forecast <span style="text-decoration: underline;">12</span>559. <span style="text-decoration: underline;">11</span>619. <span style="text-decoration: underline;">11</span>122. <span style="text-decoration: underline;">13</span>499. <span style="text-decoration: underline;">13</span>996.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 2017-12-01 forecast <span style="text-decoration: underline;">14</span>499. <span style="text-decoration: underline;">13</span>380. <span style="text-decoration: underline;">12</span>788. <span style="text-decoration: underline;">15</span>618. <span style="text-decoration: underline;">16</span>211.</span></span></code></pre>
<p>We can build the same plot with dates in the x-axis now.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_sweep.html">sw_sweep</a></span><span class="op">(</span><span class="va">fcast_ets</span>, timetk_idx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">price</span>, color <span class="op">=</span> <span class="va">key</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lo.95</span>, ymax <span class="op">=</span> <span class="va">hi.95</span><span class="op">)</span>, </span>
<span>                fill <span class="op">=</span> <span class="st">"#D5DBFF"</span>, color <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lo.80</span>, ymax <span class="op">=</span> <span class="va">hi.80</span>, fill <span class="op">=</span> <span class="va">key</span><span class="op">)</span>, </span>
<span>                fill <span class="op">=</span> <span class="st">"#596DD5"</span>, color <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Alcohol Sales, ETS Model Forecast"</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Millions"</span>, </span>
<span>         subtitle <span class="op">=</span> <span class="st">"Irregular Time Index"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html" class="external-link">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html" class="external-link">scale_fill_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html" class="external-link">theme_tq</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Warning in .check_tzones(e1, e2): 'tzone' attributes are inconsistent</span></span></code></pre>
<p><img src="SW00_Introduction_to_sweep_files/figure-html/unnamed-chunk-20-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>In this example, there is not much benefit to returning an irregular
time series. However, when working with frequencies below monthly, the
ability to return irregular index values becomes more apparent.</p>
</div>
</div>
<div class="section level2">
<h2 id="recap">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
</h2>
<p>This was an overview of how various functions within the
<code>sweep</code> package can be used to assist in forecast analysis.
In the next vignette, we discuss some more powerful concepts including
forecasting at scale with grouped time series analysis.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Dancho, Davis Vaughan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
